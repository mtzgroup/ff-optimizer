Note: Failed to import the optional openff.evaluator package. 
Note: Failed to import the optional openff-toolkit package. 
Note: Failed to import the optional openff.recharge package.
#======================================================================#
#| [1m            Welcome to ForceBalance version 1.8.1! =D             [0m |#
#| [1m                 Force Field Optimization System                  [0m |#
#| [1m                                                                  [0m |#
#| [1m                             Authors:                             [0m |#
#| [1m                          Lee-Ping Wang                           [0m |#
#| [1m                  Yudong Qiu, Keri A. McKiernan                   [0m |#
#| [1m          Jeffrey R. Wagner, Hyesu Jang, Simon Boothroyd          [0m |#
#| [1m          Arthur Vigil, Erik G. Brandt, John Stoppelman           [0m |#
#| [1m                  Johnny Israeli, Matt Thompson                   [0m |#
#======================================================================#

                          [44m     [0m                                        
                       [44m        [0m      [43m     [0m                              
                    [44m        [0m   [44m  [0m    [43m         [0m                          
                 [44m       [0m    [44m      [0m      [43m         [0m                       
             [44m        [0m    [44m        [0m          [43m         [0m                    
          [44m        [0m    [44m        [0m                 [43m        [0m                 
       [44m        [0m    [44m       [0m                        [43m        [0m              
    [44m        [0m   [44m        [0m                              [43m         [0m          
   [44m      [0m   [44m        [0m               `.:+@@###@'          [43m         [0m       
    [44m [0m    [44m        [0m          ,;'+###############.             [43m     [0m       
      [44m        [0m         +################':`                    [43m [0m        
      [44m     [0m              `.,,...####+.                                  
                                ,#####      +##.               [44m   [0m   [44m   [0m
 [43m    [0m                            #####      ######             [44m   [0m   [44m   [0m
 [43m    [0m                ###'        ####'     :#####'             [44m   [0m   [44m   [0m
 [43m    [0m                :####@      ####.    ,####'               [44m   [0m   [44m   [0m
 [43m    [0m                 ######     ####    +###+                 [44m   [0m   [44m   [0m
 [43m    [0m                  #####     ####   ###;                   [44m   [0m   [44m   [0m
 [43m    [0m                   :##      ####  ++`                     [44m   [0m   [44m   [0m
 [43m    [0m                            ####``..:;+##############+`   [44m   [0m   [44m   [0m
 [43m    [0m             .,:;;'++##################################`  [44m   [0m   [44m   [0m
 [43m    [0m    `############################++++''';;;;;;;;;;;'';    [44m   [0m   [44m   [0m
 [43m    [0m      ,########':,.``       ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
      [44m    [0m                       ####                                   
     [44m        [0m                    ####                                   
    [44m [0m    [44m       [0m                 ####                       [43m     [0m       
   [44m     [0m    [44m        [0m             ####                    [43m        [0m       
   [44m        [0m    [44m        [0m          ###                  [43m         [0m         
      [44m        [0m    [44m        [0m        +`               [43m        [0m             
          [44m        [0m   [44m        [0m                   [43m        [0m                
             [44m        [0m   [44m         [0m           [43m         [0m                   
                [44m        [0m    [44m       [0m      [43m         [0m                      
                   [44m        [0m    [44m   [0m    [43m        [0m                          
                      [44m        [0m       [43m      [0m                             
                          [44m      [0m      [43m  [0m                                
                             [44m  [0m                                         

Reading options from file: opt_2.in
#========================================================#
#| [95m  Options at their default values are not printed   [0m |#
#| [95m        Use 'verbose_options True' to Enable        [0m |#
#========================================================#
Reading force field from file: sol.mol2
Reading force field from file: sol.frcmod
#=========================================================#
#| [92m Starting parameter indices, physical values and IDs [0m |#
#=========================================================#
   0 [ -6.1178e-01 ] : COUL:SOL-1
   1 [  3.0589e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 ] : VDWS/OW
   5 [  2.9448e-01 ] : VDWT/OW
-----------------------------------------------------------
#=========================================================#
#| [91m Rescaling Factors by Type (Lower Takes Precedence): [0m |#
#=========================================================#
   COUL                                 : 1.00000e+00
   ANGLESK                              : 6.05928e+02
   ANGLESB                              : 5.72958e+01
   VDWS                                 : 5.29177e-02
   VDWT                                 : 2.47896e+00
-----------------------------------------------------------
#========================================================#
#| [91m   Rescaling Types / Factors by Parameter Number:   [0m |#
#========================================================#
   0 [    COUL                          : 1.00000e+00 ] : COUL:SOL-1
   1 [    COUL                          : 1.00000e+00 ] : COUL:SOL-2
   2 [    ANGLESK                       : 6.05928e+02 ] : ANGLESK/HW-OW-HW
   3 [    ANGLESB                       : 5.72958e+01 ] : ANGLESB/HW-OW-HW
   4 [    VDWS                          : 5.29177e-02 ] : VDWS/OW
   5 [    VDWT                          : 2.47896e+00 ] : VDWT/OW
----------------------------------------------------------
Building charge constraints...
Parameter 0 occurs 1 times in molecule SOL in locations [0] (COUL:SOL-1)
Parameter 1 occurs 2 times in molecule SOL in locations [1, 2] (COUL:SOL-2 COUL:SOL-3)
#========================================================#
#| [92m               Setup for force field                [0m |#
#========================================================#
fnms                      ['sol.mol2', 'sol.frcmod'] 
constrain_charge          True 
----------------------------------------------------------
Relative energy fitting: Subtracting (MM - QM) energy gap from all relative energy calculations - this is the default.
The 'amberhome' option was not specified; using default.
Received an error message:

[====] [91mError Message[0m [====]
STOP PMEMD Terminated Abnormally!
[====] [91mEnd o'Message[0m [====]
/global/software/Amber/20-GCC-4.8.1/build2/bin/pmemd.cuda -h gave a return code of 1 (it may have crashed) -- carrying on
pmemd.cuda gave a nonzero returncode; CUDA environment variables likely missing
[1;91mPress Enter or wait 10 seconds (I assume no responsibility for what happens after this!)[0m
Cannot find a unique file with extension .mdin in /home/curtie/7_FF_fitting/0_ff-optimizer/1_active_learning/ff-optimizer/tests/full/model_2/1_opt/targets/dynamics (0 found; )
[91mWriting amber-all.crd file with no periodic box information[0m
Fitting the forces on all atoms
#========================================================#
#| [92m            Setup for target dynamics :             [0m |#
#========================================================#
leapcmd                   setup.leap 
name                      dynamics 
type                      ABINITIO_AMBER 
backup                    False 
tgtdir                    targets/dynamics 
writelevel                1 
shots                     2 
----------------------------------------------------------
Relative energy fitting: Subtracting (MM - QM) energy gap from all relative energy calculations - this is the default.
Received an error message:

[====] [91mError Message[0m [====]
STOP PMEMD Terminated Abnormally!
[====] [91mEnd o'Message[0m [====]
/global/software/Amber/20-GCC-4.8.1/build2/bin/pmemd.cuda -h gave a return code of 1 (it may have crashed) -- carrying on
pmemd.cuda gave a nonzero returncode; CUDA environment variables likely missing
[1;91mPress Enter or wait 10 seconds (I assume no responsibility for what happens after this!)[0m
[91mWriting amber-all.crd file with no periodic box information[0m
Fitting the forces on all atoms
#========================================================#
#| [92m             Setup for target train_1 :             [0m |#
#========================================================#
leapcmd                   setup.leap 
name                      train_1 
type                      ABINITIO_AMBER 
backup                    False 
tgtdir                    targets/train_1 
writelevel                1 
shots                     10 
----------------------------------------------------------
Relative energy fitting: Subtracting (MM - QM) energy gap from all relative energy calculations - this is the default.
Received an error message:

[====] [91mError Message[0m [====]
STOP PMEMD Terminated Abnormally!
[====] [91mEnd o'Message[0m [====]
/global/software/Amber/20-GCC-4.8.1/build2/bin/pmemd.cuda -h gave a return code of 1 (it may have crashed) -- carrying on
pmemd.cuda gave a nonzero returncode; CUDA environment variables likely missing
[1;91mPress Enter or wait 10 seconds (I assume no responsibility for what happens after this!)[0m
[91mWriting amber-all.crd file with no periodic box information[0m
Fitting the forces on all atoms
#========================================================#
#| [92m             Setup for target train_2 :             [0m |#
#========================================================#
leapcmd                   setup.leap 
name                      train_2 
type                      ABINITIO_AMBER 
backup                    False 
tgtdir                    targets/train_2 
writelevel                1 
shots                     10 
----------------------------------------------------------
Using parabolic regularization (Gaussian prior) with strength 1.0e-02 (+), 0.0e+00 (x)
#========================================================#
#| [92m           Setup for objective function :           [0m |#
#========================================================#
penalty_additive          0.01 
----------------------------------------------------------
#========================================================#
#| [92m                Setup for optimizer                 [0m |#
#========================================================#
jobtype                   BFGS 
trust0                    -1.0 
convergence_objective     0.001 
backup                    False 
input_file                opt_2.in 
criteria                  2 
----------------------------------------------------------
Calculation started at 2022-07-20 10:29 PM
#========================================================#
#| [1m                  Main Optimizer                    [0m |#
#| [1m       BFGS Method (Hessian Diagonal Search)        [0m |#
#| [1m                                                    [0m |#
#| [1m       [0mConvergence criteria (2 of 3 needed):        [0m |#
#| [1m          [0mObjective Function  : 1.000e-03           [0m |#
#| [1m          [0mNorm of Gradient    : 1.000e-03           [0m |#
#| [1m          [0mParameter step size : 1.000e-04           [0m |#
#========================================================#
#========================================================#
#|       Color Key for Objective Function -=X2=-        |#
#|  [1mBold[0m = Initial step                                 |#
#|  [92mGreen = Current lowest value of objective function[0m  |#
#|  [91mRed = Objective function rises, step rejected[0m       |#
#|  [0mNo color = Not at the lowest value                  |#
#========================================================#
#========================================================#
#| [94m     Iteration 0: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 4.99207e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2665        2.0512     61.7435%     0.3812    1.000     0.3812 
    Gradient (kJ/mol/A)      50.4775      146.9576     34.3484%     0.1180    1.000     0.1180 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  80.4484 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00158e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1559.1887     1558.6809    100.0326%     1.0007    1.000     1.0007 
    Gradient (kJ/mol/A)   10813.7031    10808.7056    100.0462%     1.0009    1.000     1.0009 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.1027 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_2  Type: AbInitio_AMBER  Objective = 2.03937e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)         412.0437      407.1729    101.1963%     1.0241    1.000     1.0241 
    Gradient (kJ/mol/A)    1434.7871     1423.9323    100.7623%     1.0153    1.000     1.0153 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 803.4364 kJ/mol/A
#====================================================================#
#| [94m                  Objective Function Breakdown                  [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution [0m |#
#====================================================================#
dynamics                       0.49921      0.333 [94m     1.66402e-01[0m 
train_1                        2.00158      0.333 [94m     6.67192e-01[0m 
train_2                        2.03937      0.333 [94m     6.79791e-01[0m 
Regularization                 0.00000      1.000 [94m     0.00000e+00[0m 
Total                                             [94m     1.51339e+00[0m 
----------------------------------------------------------------------

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     0   0.000e+00   0.000e+00   2.309e-02[1m   1.51339e+00[0m   0.000e+00      0.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  1.47725538e-02 ] : COUL:SOL-2
   2 [  0.00000000e+00 ] : ANGLESK/HW-OW-HW
   3 [  0.00000000e+00 ] : ANGLESB/HW-OW-HW
   4 [ -1.02415723e-03 ] : VDWS/OW
   5 [ -1.77100768e-02 ] : VDWT/OW
----------------------------------------------------------
Calculating nonlinear optimization step
Starting Hessian diagonal search with step size 2.2632e-02
Hessian diagonal search: H+0.0000*I, length 2.2632e-02, result  2.8895e-04
Hessian diagonal search: H+9.0000*I, length 2.3039e-03, result -4.4783e-05
Hessian diagonal search: H+61.6869*I, length 3.6814e-04, result -8.2840e-06
Hessian diagonal search: H+9.0000*I, length 2.3039e-03, result -4.4783e-05
Hessian diagonal search: H+23.5623*I, length 9.3910e-04, result -2.0283e-05
Hessian diagonal search: H+3.4377*I, length 5.1787e-03, result -7.7089e-05
Hessian diagonal search: H+1.3131*I, length 9.8947e-03, result -7.3387e-05
Hessian diagonal search: H+2.7060*I, length 6.1957e-03, result -8.2249e-05
Hessian diagonal search: H+2.3828*I, length 6.7843e-03, result -8.3739e-05
Hessian diagonal search: H+1.9368*I, length 7.8074e-03, result -8.3717e-05
Hessian diagonal search: H+2.1577*I, length 7.2648e-03, result -8.4142e-05
Hessian diagonal search: H+2.1569*I, length 7.2665e-03, result -8.4142e-05
Hessian diagonal search: H+2.1547*I, length 7.2716e-03, result -8.4142e-05
Hessian diagonal search: H+2.0701*I, length 7.4707e-03, result -8.4090e-05
Hessian diagonal search: H+2.1222*I, length 7.3469e-03, result -8.4138e-05
Hessian diagonal search: H+2.1422*I, length 7.3002e-03, result -8.4142e-05
Hessian diagonal search: H+2.1483*I, length 7.2862e-03, result -8.4143e-05
Hessian diagonal search: H+2.1476*I, length 7.2879e-03, result -8.4143e-05
Hessian diagonal search: H+2.1458*I, length 7.2921e-03, result -8.4143e-05
Hessian diagonal search: H+2.1469*I, length 7.2896e-03, result -8.4143e-05
Optimization step found (length 7.2879e-03)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [  0.0000e+00 - 4.6636e-03 = -4.6636e-03 ] : COUL:SOL-2
   2 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : ANGLESK/HW-OW-HW
   3 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : ANGLESB/HW-OW-HW
   4 [  0.0000e+00 + 3.2332e-04 =  3.2332e-04 ] : VDWS/OW
   5 [  0.0000e+00 + 5.5910e-03 =  5.5910e-03 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -6.1178e-01 + 1.8655e-03 = -6.0991e-01 ] : COUL:SOL-1
   1 [  3.0589e-01 - 9.3273e-04 =  3.0496e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 + 1.7110e-05 =  1.7564e+00 ] : VDWS/OW
   5 [  2.9448e-01 + 1.3860e-02 =  3.0834e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_2.sav
Setting finite difference step to 7.2879e-04
#========================================================#
#| [94m     Iteration 1: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -7.3e-04                                                   fdwrap: callM [0] =  7.3e-04                                                   fdwrap: callM [1] = -7.3e-04                                                   fdwrap: callM [1] =  7.3e-04                                                   fdwrap: callM [2] = -7.3e-04                                                   fdwrap: callM [2] =  7.3e-04                                                   fdwrap: callM [3] = -7.3e-04                                                   fdwrap: callM [3] =  7.3e-04                                                   fdwrap: callM [4] = -7.3e-04                                                   fdwrap: callM [4] =  7.3e-04                                                   fdwrap: callM [5] = -7.3e-04                                                   fdwrap: callM [5] =  7.3e-04                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 4.99438e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2595        2.0512     61.4036%     0.3770    1.000     0.3770 
    Gradient (kJ/mol/A)      51.4138      146.9576     34.9854%     0.1224    1.000     0.1224 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  80.4713 kJ/mol/A
fdwrap: callM [0] = -7.3e-04                                                   fdwrap: callM [0] =  7.3e-04                                                   fdwrap: callM [1] = -7.3e-04                                                   fdwrap: callM [1] =  7.3e-04                                                   fdwrap: callM [2] = -7.3e-04                                                   fdwrap: callM [2] =  7.3e-04                                                   fdwrap: callM [3] = -7.3e-04                                                   fdwrap: callM [3] =  7.3e-04                                                   fdwrap: callM [4] = -7.3e-04                                                   fdwrap: callM [4] =  7.3e-04                                                   fdwrap: callM [5] = -7.3e-04                                                   fdwrap: callM [5] =  7.3e-04                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00158e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1559.1903     1558.6809    100.0327%     1.0007    1.000     1.0007 
    Gradient (kJ/mol/A)   10813.6974    10808.7056    100.0462%     1.0009    1.000     1.0009 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.1063 kJ/mol/A
fdwrap: callM [0] = -7.3e-04                                                   fdwrap: callM [0] =  7.3e-04                                                   fdwrap: callM [1] = -7.3e-04                                                   fdwrap: callM [1] =  7.3e-04                                                   fdwrap: callM [2] = -7.3e-04                                                   fdwrap: callM [2] =  7.3e-04                                                   fdwrap: callM [3] = -7.3e-04                                                   fdwrap: callM [3] =  7.3e-04                                                   fdwrap: callM [4] = -7.3e-04                                                   fdwrap: callM [4] =  7.3e-04                                                   fdwrap: callM [5] = -7.3e-04                                                   fdwrap: callM [5] =  7.3e-04                                                   
#================================================================================================#
#|                Target: train_2  Type: AbInitio_AMBER  Objective = 2.03889e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)         411.9509      407.1729    101.1734%     1.0236    1.000     1.0236 
    Gradient (kJ/mol/A)    1434.7700     1423.9323    100.7611%     1.0153    1.000     1.0153 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 803.3357 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.49944      0.333 [91m     1.66479e-01[0m ( +7.695e-05 ) 
train_1                        2.00158      0.333 [91m     6.67193e-01[0m ( +3.215e-07 ) 
train_2                        2.03889      0.333 [92m     6.79629e-01[0m ( -1.619e-04 ) 
Regularization                 0.00000      1.000 [91m     5.31135e-07[0m ( +5.311e-07 ) 
Total                                             [92m     1.51330e+00[0m ( -8.414e-05 ) 
-------------------------------------------------------------------------------------
Creating the directory /home/curtie/7_FF_fitting/0_ff-optimizer/1_active_learning/ff-optimizer/tests/full/model_2/1_opt/result/opt_2 to print the force field
#=====================================================================#
#|  The force field has been written to the result/opt_2 directory.  |#
#|    Input file with optimization parameters saved to opt_2.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     1   7.288e-03   7.288e-03   1.831e-02[92m   1.51330e+00[0m  -8.414e-05      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  1.40715688e-02 ] : COUL:SOL-2
   2 [  0.00000000e+00 ] : ANGLESK/HW-OW-HW
   3 [  0.00000000e+00 ] : ANGLESB/HW-OW-HW
   4 [  4.44085088e-04 ] : VDWS/OW
   5 [  1.17072399e-02 ] : VDWT/OW
----------------------------------------------------------
Convergence criterion reached for objective function (1.00e-03)
Calculating nonlinear optimization step
Finding trust radius: H+0.0000*I, length 2.2918e-02 (target 7.2879e-03)
Finding trust radius: H+9.0000*I, length 1.6267e-03 (target 7.2879e-03)
Finding trust radius: H+61.6869*I, length 2.8365e-04 (target 7.2879e-03)
Finding trust radius: H+9.0000*I, length 1.6267e-03 (target 7.2879e-03)
Finding trust radius: H+23.5623*I, length 6.9826e-04 (target 7.2879e-03)
Finding trust radius: H+3.4377*I, length 3.5655e-03 (target 7.2879e-03)
Finding trust radius: H+1.3131*I, length 7.1973e-03 (target 7.2879e-03)
Finding trust radius: H+0.5016*I, length 1.2372e-02 (target 7.2879e-03)
Finding trust radius: H+1.8427*I, length 5.6975e-03 (target 7.2879e-03)
Finding trust radius: H+0.9579*I, length 8.7855e-03 (target 7.2879e-03)
Finding trust radius: H+1.3512*I, length 7.0617e-03 (target 7.2879e-03)
Finding trust radius: H+1.2978*I, length 7.2533e-03 (target 7.2879e-03)
Finding trust radius: H+1.2876*I, length 7.2910e-03 (target 7.2879e-03)
Finding trust radius: H+1.2884*I, length 7.2882e-03 (target 7.2879e-03)
Finding trust radius: H+1.2889*I, length 7.2864e-03 (target 7.2879e-03)
Starting Hessian diagonal search with step size 7.2882e-03
Hessian diagonal search: H+1.2884*I, length 7.2882e-03, result -1.1080e-04
Hessian diagonal search: H+56.8556*I, length 3.0665e-04, result -5.5211e-06
Hessian diagonal search: H+85.1701*I, length 2.0789e-04, result -3.7627e-06
Hessian diagonal search: H+1.2884*I, length 7.2882e-03, result -1.1080e-04
Hessian diagonal search: H+7.9725*I, length 1.8017e-03, result -3.0445e-05
Hessian diagonal search: H+12.8281*I, length 1.2000e-03, result -2.0732e-05
Hessian diagonal search: H+0.0864*I, length 1.9957e-02, result -2.7623e-04
Hessian diagonal search: H+0.4878*I, length 1.2529e-02, result -1.8166e-04
Hessian diagonal search: H+0.0094*I, length 2.2553e-02, result -3.0783e-04
Hessian diagonal search: H+0.0029*I, length 2.2804e-02, result -3.1084e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1220e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Hessian diagonal search: H+0.0014*I, length 2.2863e-02, result -3.1156e-04
Hessian diagonal search: H+0.0002*I, length 2.2910e-02, result -3.1211e-04
Hessian diagonal search: H+0.0000*I, length 2.2917e-02, result -3.1219e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Hessian diagonal search: H+0.0000*I, length 2.2918e-02, result -3.1221e-04
Optimization step found (length 2.2918e-02)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [ -4.6636e-03 - 2.2910e-02 = -2.7574e-02 ] : COUL:SOL-2
   2 [  0.0000e+00 + 2.1751e-19 =  2.1751e-19 ] : ANGLESK/HW-OW-HW
   3 [  0.0000e+00 - 6.2462e-21 = -6.2462e-21 ] : ANGLESB/HW-OW-HW
   4 [  3.2332e-04 + 1.9632e-04 =  5.1964e-04 ] : VDWS/OW
   5 [  5.5910e-03 - 5.5485e-04 =  5.0362e-03 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -6.0991e-01 + 9.1641e-03 = -6.0075e-01 ] : COUL:SOL-1
   1 [  3.0496e-01 - 4.5821e-03 =  3.0037e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 + 1.0389e-05 =  1.7564e+00 ] : VDWS/OW
   5 [  3.0834e-01 - 1.3754e-03 =  3.0697e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_2.sav
Setting finite difference step to 1.0000e-03
#========================================================#
#| [94m     Iteration 2: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 4.99366e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2579        2.0512     61.3281%     0.3761    1.000     0.3761 
    Gradient (kJ/mol/A)      51.5929      146.9576     35.1074%     0.1233    1.000     0.1233 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  80.5833 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00158e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1559.1878     1558.6809    100.0325%     1.0007    1.000     1.0007 
    Gradient (kJ/mol/A)   10813.7042    10808.7056    100.0462%     1.0009    1.000     1.0009 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.1238 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_2  Type: AbInitio_AMBER  Objective = 2.03800e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)         411.7678      407.1729    101.1285%     1.0227    1.000     1.0227 
    Gradient (kJ/mol/A)    1434.7877     1423.9323    100.7624%     1.0153    1.000     1.0153 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 802.8458 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.49937      0.333 [92m     1.66455e-01[0m ( -2.405e-05 ) 
train_1                        2.00158      0.333 [92m     6.67192e-01[0m ( -6.439e-07 ) 
train_2                        2.03800      0.333 [92m     6.79334e-01[0m ( -2.948e-04 ) 
Regularization                 0.00001      1.000 [91m     7.85958e-06[0m ( +7.328e-06 ) 
Total                                             [92m     1.51299e+00[0m ( -3.122e-04 ) 
-------------------------------------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_2 directory.  |#
#|    Input file with optimization parameters saved to opt_2.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     2   2.803e-02   2.292e-02   1.645e-02[92m   1.51299e+00[0m  -3.122e-04      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  1.26582319e-02 ] : COUL:SOL-2
   2 [  4.35026081e-21 ] : ANGLESK/HW-OW-HW
   3 [ -1.24923397e-22 ] : ANGLESB/HW-OW-HW
   4 [  3.85036006e-04 ] : VDWS/OW
   5 [  1.05029120e-02 ] : VDWT/OW
----------------------------------------------------------
Convergence criterion reached for objective function (1.00e-03)
Calculating nonlinear optimization step
Finding trust radius: H+0.0000*I, length 2.0522e-01 (target 2.2918e-02)
Finding trust radius: H+9.0000*I, length 1.5891e-03 (target 2.2918e-02)
Finding trust radius: H+61.6869*I, length 2.5856e-04 (target 2.2918e-02)
Finding trust radius: H+9.0000*I, length 1.5891e-03 (target 2.2918e-02)
Finding trust radius: H+23.5623*I, length 6.5018e-04 (target 2.2918e-02)
Finding trust radius: H+3.4377*I, length 3.8484e-03 (target 2.2918e-02)
Finding trust radius: H+1.3131*I, length 9.4421e-03 (target 2.2918e-02)
Finding trust radius: H+0.5016*I, length 2.2775e-02 (target 2.2918e-02)
Finding trust radius: H+0.1916*I, length 5.0448e-02 (target 2.2918e-02)
Finding trust radius: H+0.7663*I, length 1.5546e-02 (target 2.2918e-02)
Finding trust radius: H+0.3659*I, length 2.9952e-02 (target 2.2918e-02)
Finding trust radius: H+0.5433*I, length 2.1213e-02 (target 2.2918e-02)
Finding trust radius: H+0.5059*I, length 2.2603e-02 (target 2.2918e-02)
Finding trust radius: H+0.4973*I, length 2.2947e-02 (target 2.2918e-02)
Finding trust radius: H+0.4980*I, length 2.2919e-02 (target 2.2918e-02)
Finding trust radius: H+0.4982*I, length 2.2909e-02 (target 2.2918e-02)
Finding trust radius: H+0.4977*I, length 2.2929e-02 (target 2.2918e-02)
Starting Hessian diagonal search with step size 2.2919e-02
Hessian diagonal search: H+0.4980*I, length 2.2919e-02, result -2.8668e-04
Hessian diagonal search: H+33.9040*I, length 4.6032e-04, result -7.3699e-06
Hessian diagonal search: H+57.3633*I, length 2.7746e-04, result -4.4883e-06
Hessian diagonal search: H+0.4980*I, length 2.2919e-02, result -2.8668e-04
Hessian diagonal search: H+6.0360*I, length 2.2919e-03, result -3.4043e-05
Hessian diagonal search: H+7.0767*I, length 1.9810e-03, result -2.9713e-05
Hessian diagonal search: H+0.0084*I, length 1.8096e-01, result -1.3787e-03
Hessian diagonal search: H+0.6737*I, length 1.7482e-02, result -2.2351e-04
Hessian diagonal search: H+0.0022*I, length 1.9815e-01, result -1.4170e-03
Hessian diagonal search: H+0.0022*I, length 1.9818e-01, result -1.4171e-03
Hessian diagonal search: H+0.0000*I, length 2.0520e-01, result -1.4285e-03
Hessian diagonal search: H+0.0011*I, length 2.0154e-01, result -1.4228e-03
Hessian diagonal search: H+0.0000*I, length 2.0522e-01, result -1.4285e-03
Hessian diagonal search: H+0.0000*I, length 2.0522e-01, result -1.4285e-03
Hessian diagonal search: H+0.0000*I, length 2.0522e-01, result -1.4285e-03
Hessian diagonal search: H+0.0000*I, length 2.0522e-01, result -1.4285e-03
Optimization step found (length 2.0522e-01)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [ -2.7574e-02 - 2.0515e-01 = -2.3272e-01 ] : COUL:SOL-2
   2 [  2.1751e-19 + 3.2101e-18 =  3.4276e-18 ] : ANGLESK/HW-OW-HW
   3 [ -6.2462e-21 - 3.0556e-19 = -3.1181e-19 ] : ANGLESB/HW-OW-HW
   4 [  5.1964e-04 + 1.8875e-03 =  2.4071e-03 ] : VDWS/OW
   5 [  5.0362e-03 - 4.9194e-03 =  1.1678e-04 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -6.0075e-01 + 8.2059e-02 = -5.1869e-01 ] : COUL:SOL-1
   1 [  3.0037e-01 - 4.1030e-02 =  2.5934e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 + 9.9880e-05 =  1.7565e+00 ] : VDWS/OW
   5 [  3.0697e-01 - 1.2195e-02 =  2.9477e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_2.sav
#========================================================#
#| [94m     Iteration 3: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 5.00747e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2455        2.0512     60.7207%     0.3687    1.000     0.3687 
    Gradient (kJ/mol/A)      53.4016      146.9576     36.3381%     0.1320    1.000     0.1320 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  81.5278 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00156e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1559.1680     1558.6809    100.0312%     1.0006    1.000     1.0006 
    Gradient (kJ/mol/A)   10813.7637    10808.7056    100.0468%     1.0009    1.000     1.0009 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.2690 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_2  Type: AbInitio_AMBER  Objective = 2.03075e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)         410.2581      407.1729    100.7577%     1.0152    1.000     1.0152 
    Gradient (kJ/mol/A)    1434.9522     1423.9323    100.7739%     1.0155    1.000     1.0155 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 798.8132 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.50075      0.333 [91m     1.66916e-01[0m ( +4.601e-04 ) 
train_1                        2.00156      0.333 [92m     6.67187e-01[0m ( -4.811e-06 ) 
train_2                        2.03075      0.333 [92m     6.76916e-01[0m ( -2.418e-03 ) 
Regularization                 0.00054      1.000 [91m     5.41654e-04[0m ( +5.338e-04 ) 
Total                                             [92m     1.51156e+00[0m ( -1.428e-03 ) 
-------------------------------------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_2 directory.  |#
#|    Input file with optimization parameters saved to opt_2.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     3   2.327e-01   2.052e-01   1.848e-03[92m   1.51156e+00[0m  -1.428e-03      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  1.46319827e-03 ] : COUL:SOL-2
   2 [  6.85525004e-20 ] : ANGLESK/HW-OW-HW
   3 [ -6.23616587e-21 ] : ANGLESB/HW-OW-HW
   4 [ -1.58130895e-04 ] : VDWS/OW
   5 [ -1.11814422e-03 ] : VDWT/OW
----------------------------------------------------------
Calculating nonlinear optimization step
Starting Hessian diagonal search with step size 2.6230e-02
Hessian diagonal search: H+0.0000*I, length 2.6230e-02, result -2.1433e-05
Hessian diagonal search: H+9.0000*I, length 1.7936e-04, result -3.0738e-07
Hessian diagonal search: H+23.5623*I, length 7.3200e-05, result -1.3052e-07
Hessian diagonal search: H+0.0000*I, length 2.6230e-02, result -2.1433e-05
Hessian diagonal search: H+3.4377*I, length 4.3599e-04, result -7.0499e-07
Hessian diagonal search: H+1.3131*I, length 1.0745e-03, result -1.6329e-06
Hessian diagonal search: H+0.1141*I, length 8.5621e-03, result -1.0754e-05
Hessian diagonal search: H+0.0966*I, length 9.5497e-03, result -1.1749e-05
Hessian diagonal search: H+0.0000*I, length 2.6215e-02, result -2.1430e-05
Hessian diagonal search: H+0.0000*I, length 2.6230e-02, result -2.1433e-05
Hessian diagonal search: H+0.0000*I, length 2.6230e-02, result -2.1433e-05
Hessian diagonal search: H+0.0000*I, length 2.6230e-02, result -2.1433e-05
Optimization step found (length 2.6230e-02)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [ -2.3272e-01 - 2.6227e-02 = -2.5895e-01 ] : COUL:SOL-2
   2 [  3.4276e-18 + 2.1736e-19 =  3.6450e-18 ] : ANGLESK/HW-OW-HW
   3 [ -3.1181e-19 + 6.5764e-20 = -2.4604e-19 ] : ANGLESB/HW-OW-HW
   4 [  2.4071e-03 + 3.6145e-04 =  2.7686e-03 ] : VDWS/OW
   5 [  1.1678e-04 - 1.3368e-04 = -1.6896e-05 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -5.1869e-01 + 1.0491e-02 = -5.0820e-01 ] : COUL:SOL-1
   1 [  2.5934e-01 - 5.2454e-03 =  2.5410e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7565e+00 + 1.9127e-05 =  1.7565e+00 ] : VDWS/OW
   5 [  2.9477e-01 - 3.3138e-04 =  2.9444e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_2.sav
#========================================================#
#| [94m     Iteration 4: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 5.01164e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2435        2.0512     60.6240%     0.3675    1.000     0.3675 
    Gradient (kJ/mol/A)      53.7225      146.9576     36.5565%     0.1336    1.000     0.1336 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  81.6406 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00156e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1559.1660     1558.6809    100.0311%     1.0006    1.000     1.0006 
    Gradient (kJ/mol/A)   10813.7704    10808.7056    100.0469%     1.0009    1.000     1.0009 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.2861 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_2  Type: AbInitio_AMBER  Objective = 2.02988e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)         410.0771      407.1729    100.7132%     1.0143    1.000     1.0143 
    Gradient (kJ/mol/A)    1434.9719     1423.9323    100.7753%     1.0156    1.000     1.0156 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 798.3431 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.50116      0.333 [91m     1.67055e-01[0m ( +1.393e-04 ) 
train_1                        2.00156      0.333 [92m     6.67187e-01[0m ( -4.586e-07 ) 
train_2                        2.02988      0.333 [92m     6.76627e-01[0m ( -2.892e-04 ) 
Regularization                 0.00067      1.000 [91m     6.70623e-04[0m ( +1.290e-04 ) 
Total                                             [92m     1.51154e+00[0m ( -2.143e-05 ) 
-------------------------------------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_2 directory.  |#
#|    Input file with optimization parameters saved to opt_2.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     4   2.590e-01   2.623e-02   2.535e-04[92m   1.51154e+00[0m  -2.143e-05      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  1.80616205e-04 ] : COUL:SOL-2
   2 [  7.28997760e-20 ] : ANGLESK/HW-OW-HW
   3 [ -4.92088499e-21 ] : ANGLESB/HW-OW-HW
   4 [ -1.02507628e-04 ] : VDWS/OW
   5 [ -1.45456252e-04 ] : VDWT/OW
----------------------------------------------------------
Convergence criterion reached for gradient norm (1.00e-03)
Convergence criterion reached for objective function (1.00e-03)
#========================================================#
#| [92m               [0m[1mOptimization Converged[0m               [0m |#
#| [92m           Final objective function value           [0m |#
#| [92m  Full:  1.511539e+00  Un-penalized:  1.510869e+00  [0m |#
#========================================================#
#========================================================#
#| [94m           Final optimization parameters:           [0m |#
#========================================================#
   0 [  0.0000e+00 ] : COUL:SOL-1
   1 [ -2.5895e-01 ] : COUL:SOL-2
   2 [  3.6450e-18 ] : ANGLESK/HW-OW-HW
   3 [ -2.4604e-19 ] : ANGLESB/HW-OW-HW
   4 [  2.7686e-03 ] : VDWS/OW
   5 [ -1.6896e-05 ] : VDWT/OW
#========================================================#
#| [94m             Final physical parameters:             [0m |#
#========================================================#
   0 [ -5.0820e-01 ] : COUL:SOL-1
   1 [  2.5410e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7565e+00 ] : VDWS/OW
   5 [  2.9444e-01 ] : VDWT/OW
----------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_2 directory.  |#
#|    Input file with optimization parameters saved to opt_2.sav.    |#
#=====================================================================#
Wall time since calculation start: 26.9 seconds
#========================================================#
#| [1;44;93m               Calculation Finished.                [0m |#
#| [1;44;93m     ---==(  May the Force be with you!  )==---     [0m |#
#========================================================#
