Note: Failed to import the optional openff.evaluator package. 
Note: Failed to import the optional openff-toolkit package. 
Note: Failed to import the optional openff.recharge package.
#======================================================================#
#| [1m            Welcome to ForceBalance version 1.8.1! =D             [0m |#
#| [1m                 Force Field Optimization System                  [0m |#
#| [1m                                                                  [0m |#
#| [1m                             Authors:                             [0m |#
#| [1m                          Lee-Ping Wang                           [0m |#
#| [1m                  Yudong Qiu, Keri A. McKiernan                   [0m |#
#| [1m          Jeffrey R. Wagner, Hyesu Jang, Simon Boothroyd          [0m |#
#| [1m          Arthur Vigil, Erik G. Brandt, John Stoppelman           [0m |#
#| [1m                  Johnny Israeli, Matt Thompson                   [0m |#
#======================================================================#

                          [44m     [0m                                        
                       [44m        [0m      [43m     [0m                              
                    [44m        [0m   [44m  [0m    [43m         [0m                          
                 [44m       [0m    [44m      [0m      [43m         [0m                       
             [44m        [0m    [44m        [0m          [43m         [0m                    
          [44m        [0m    [44m        [0m                 [43m        [0m                 
       [44m        [0m    [44m       [0m                        [43m        [0m              
    [44m        [0m   [44m        [0m                              [43m         [0m          
   [44m      [0m   [44m        [0m               `.:+@@###@'          [43m         [0m       
    [44m [0m    [44m        [0m          ,;'+###############.             [43m     [0m       
      [44m        [0m         +################':`                    [43m [0m        
      [44m     [0m              `.,,...####+.                                  
                                ,#####      +##.               [44m   [0m   [44m   [0m
 [43m    [0m                            #####      ######             [44m   [0m   [44m   [0m
 [43m    [0m                ###'        ####'     :#####'             [44m   [0m   [44m   [0m
 [43m    [0m                :####@      ####.    ,####'               [44m   [0m   [44m   [0m
 [43m    [0m                 ######     ####    +###+                 [44m   [0m   [44m   [0m
 [43m    [0m                  #####     ####   ###;                   [44m   [0m   [44m   [0m
 [43m    [0m                   :##      ####  ++`                     [44m   [0m   [44m   [0m
 [43m    [0m                            ####``..:;+##############+`   [44m   [0m   [44m   [0m
 [43m    [0m             .,:;;'++##################################`  [44m   [0m   [44m   [0m
 [43m    [0m    `############################++++''';;;;;;;;;;;'';    [44m   [0m   [44m   [0m
 [43m    [0m      ,########':,.``       ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
 [43m    [0m                            ####                          [44m   [0m   [44m   [0m
      [44m    [0m                       ####                                   
     [44m        [0m                    ####                                   
    [44m [0m    [44m       [0m                 ####                       [43m     [0m       
   [44m     [0m    [44m        [0m             ####                    [43m        [0m       
   [44m        [0m    [44m        [0m          ###                  [43m         [0m         
      [44m        [0m    [44m        [0m        +`               [43m        [0m             
          [44m        [0m   [44m        [0m                   [43m        [0m                
             [44m        [0m   [44m         [0m           [43m         [0m                   
                [44m        [0m    [44m       [0m      [43m         [0m                      
                   [44m        [0m    [44m   [0m    [43m        [0m                          
                      [44m        [0m       [43m      [0m                             
                          [44m      [0m      [43m  [0m                                
                             [44m  [0m                                         

Reading options from file: opt_1.in
#========================================================#
#| [95m  Options at their default values are not printed   [0m |#
#| [95m        Use 'verbose_options True' to Enable        [0m |#
#========================================================#
Reading force field from file: sol.mol2
Reading force field from file: sol.frcmod
#=========================================================#
#| [92m Starting parameter indices, physical values and IDs [0m |#
#=========================================================#
   0 [ -6.5120e-01 ] : COUL:SOL-1
   1 [  3.2560e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 ] : VDWS/OW
   5 [  2.9777e-01 ] : VDWT/OW
-----------------------------------------------------------
#=========================================================#
#| [91m Rescaling Factors by Type (Lower Takes Precedence): [0m |#
#=========================================================#
   COUL                                 : 1.00000e+00
   ANGLESK                              : 6.05928e+02
   ANGLESB                              : 5.72958e+01
   VDWS                                 : 5.29177e-02
   VDWT                                 : 2.47896e+00
-----------------------------------------------------------
#========================================================#
#| [91m   Rescaling Types / Factors by Parameter Number:   [0m |#
#========================================================#
   0 [    COUL                          : 1.00000e+00 ] : COUL:SOL-1
   1 [    COUL                          : 1.00000e+00 ] : COUL:SOL-2
   2 [    ANGLESK                       : 6.05928e+02 ] : ANGLESK/HW-OW-HW
   3 [    ANGLESB                       : 5.72958e+01 ] : ANGLESB/HW-OW-HW
   4 [    VDWS                          : 5.29177e-02 ] : VDWS/OW
   5 [    VDWT                          : 2.47896e+00 ] : VDWT/OW
----------------------------------------------------------
Building charge constraints...
Parameter 0 occurs 1 times in molecule SOL in locations [0] (COUL:SOL-1)
Parameter 1 occurs 2 times in molecule SOL in locations [1, 2] (COUL:SOL-2 COUL:SOL-3)
#========================================================#
#| [92m               Setup for force field                [0m |#
#========================================================#
fnms                      ['sol.mol2', 'sol.frcmod'] 
constrain_charge          True 
----------------------------------------------------------
Relative energy fitting: Subtracting (MM - QM) energy gap from all relative energy calculations - this is the default.
The 'amberhome' option was not specified; using default.
Received an error message:

[====] [91mError Message[0m [====]
STOP PMEMD Terminated Abnormally!
[====] [91mEnd o'Message[0m [====]
/global/software/Amber/20-GCC-4.8.1/build2/bin/pmemd.cuda -h gave a return code of 1 (it may have crashed) -- carrying on
pmemd.cuda gave a nonzero returncode; CUDA environment variables likely missing
[1;91mPress Enter or wait 10 seconds (I assume no responsibility for what happens after this!)[0m
Cannot find a unique file with extension .mdin in /home/curtie/7_FF_fitting/1_ForceBalance/2_playground/4_small_ref/4_ff-opt_test-full/1_opt/targets/dynamics (0 found; )
[91mWriting amber-all.crd file with no periodic box information[0m
Fitting the forces on all atoms
#========================================================#
#| [92m            Setup for target dynamics :             [0m |#
#========================================================#
leapcmd                   setup.leap 
name                      dynamics 
type                      ABINITIO_AMBER 
backup                    False 
tgtdir                    targets/dynamics 
writelevel                1 
shots                     2 
----------------------------------------------------------
Relative energy fitting: Subtracting (MM - QM) energy gap from all relative energy calculations - this is the default.
Received an error message:

[====] [91mError Message[0m [====]
STOP PMEMD Terminated Abnormally!
[====] [91mEnd o'Message[0m [====]
/global/software/Amber/20-GCC-4.8.1/build2/bin/pmemd.cuda -h gave a return code of 1 (it may have crashed) -- carrying on
pmemd.cuda gave a nonzero returncode; CUDA environment variables likely missing
[1;91mPress Enter or wait 10 seconds (I assume no responsibility for what happens after this!)[0m
[91mWriting amber-all.crd file with no periodic box information[0m
Fitting the forces on all atoms
#========================================================#
#| [92m             Setup for target train_1 :             [0m |#
#========================================================#
leapcmd                   setup.leap 
name                      train_1 
type                      ABINITIO_AMBER 
backup                    False 
tgtdir                    targets/train_1 
writelevel                1 
shots                     10 
----------------------------------------------------------
Using parabolic regularization (Gaussian prior) with strength 1.0e-02 (+), 0.0e+00 (x)
#========================================================#
#| [92m           Setup for objective function :           [0m |#
#========================================================#
penalty_additive          0.01 
----------------------------------------------------------
#========================================================#
#| [92m                Setup for optimizer                 [0m |#
#========================================================#
jobtype                   BFGS 
trust0                    -1.0 
convergence_objective     0.001 
backup                    False 
input_file                opt_1.in 
criteria                  2 
----------------------------------------------------------
Calculation started at 2022-04-28 08:47 PM
#========================================================#
#| [1m                  Main Optimizer                    [0m |#
#| [1m       BFGS Method (Hessian Diagonal Search)        [0m |#
#| [1m                                                    [0m |#
#| [1m       [0mConvergence criteria (2 of 3 needed):        [0m |#
#| [1m          [0mObjective Function  : 1.000e-03           [0m |#
#| [1m          [0mNorm of Gradient    : 1.000e-03           [0m |#
#| [1m          [0mParameter step size : 1.000e-04           [0m |#
#========================================================#
#========================================================#
#|       Color Key for Objective Function -=X2=-        |#
#|  [1mBold[0m = Initial step                                 |#
#|  [92mGreen = Current lowest value of objective function[0m  |#
#|  [91mRed = Objective function rises, step rejected[0m       |#
#|  [0mNo color = Not at the lowest value                  |#
#========================================================#
#========================================================#
#| [94m     Iteration 0: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 5.00115e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2747        2.0512     62.1463%     0.3862    1.000     0.3862 
    Gradient (kJ/mol/A)      49.5965      146.9576     33.7489%     0.1139    1.000     0.1139 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  79.9516 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00204e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1568.2877     1567.5058    100.0499%     1.0010    1.000     1.0010 
    Gradient (kJ/mol/A)   11085.3496    11079.6024    100.0519%     1.0010    1.000     1.0010 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.0656 kJ/mol/A
#====================================================================#
#| [94m                  Objective Function Breakdown                  [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution [0m |#
#====================================================================#
dynamics                       0.50011      0.500 [94m     2.50057e-01[0m 
train_1                        2.00204      0.500 [94m     1.00102e+00[0m 
Regularization                 0.00000      1.000 [94m     0.00000e+00[0m 
Total                                             [94m     1.25108e+00[0m 
----------------------------------------------------------------------

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     0   0.000e+00   0.000e+00   8.624e-03[1m   1.25108e+00[0m   0.000e+00      0.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  7.65260803e-03 ] : COUL:SOL-2
   2 [  0.00000000e+00 ] : ANGLESK/HW-OW-HW
   3 [  0.00000000e+00 ] : ANGLESB/HW-OW-HW
   4 [  2.01763415e-04 ] : VDWS/OW
   5 [  3.97080259e-03 ] : VDWT/OW
----------------------------------------------------------
Calculating nonlinear optimization step
Starting Hessian diagonal search with step size 8.4547e-03
Hessian diagonal search: H+0.0000*I, length 8.4547e-03, result -1.4911e-05
Hessian diagonal search: H+9.0000*I, length 8.6066e-04, result -6.8210e-06
Hessian diagonal search: H+23.5623*I, length 3.5081e-04, result -2.9254e-06
Hessian diagonal search: H+0.0000*I, length 8.4547e-03, result -1.4911e-05
Hessian diagonal search: H+3.4377*I, length 1.9346e-03, result -1.3646e-05
Hessian diagonal search: H+1.3131*I, length 3.6963e-03, result -2.0789e-05
Hessian diagonal search: H+3.4377*I, length 1.9346e-03, result -1.3646e-05
Hessian diagonal search: H+0.7841*I, length 4.7802e-03, result -2.2681e-05
Hessian diagonal search: H+0.5718*I, length 5.4177e-03, result -2.2904e-05
Hessian diagonal search: H+0.5781*I, length 5.3963e-03, result -2.2907e-05
Hessian diagonal search: H+0.6048*I, length 5.3078e-03, result -2.2913e-05
Hessian diagonal search: H+0.6025*I, length 5.3152e-03, result -2.2913e-05
Hessian diagonal search: H+0.6018*I, length 5.3173e-03, result -2.2913e-05
Hessian diagonal search: H+0.6033*I, length 5.3124e-03, result -2.2913e-05
Hessian diagonal search: H+0.6031*I, length 5.3133e-03, result -2.2913e-05
Hessian diagonal search: H+0.6039*I, length 5.3106e-03, result -2.2913e-05
Optimization step found (length 5.3124e-03)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [  0.0000e+00 - 4.7141e-03 = -4.7141e-03 ] : COUL:SOL-2
   2 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : ANGLESK/HW-OW-HW
   3 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : ANGLESB/HW-OW-HW
   4 [  0.0000e+00 - 1.2429e-04 = -1.2429e-04 ] : VDWS/OW
   5 [  0.0000e+00 - 2.4461e-03 = -2.4461e-03 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -6.5120e-01 + 1.8856e-03 = -6.4931e-01 ] : COUL:SOL-1
   1 [  3.2560e-01 - 9.4282e-04 =  3.2466e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 - 6.5771e-06 =  1.7564e+00 ] : VDWS/OW
   5 [  2.9777e-01 - 6.0637e-03 =  2.9170e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_1.sav
Setting finite difference step to 5.3124e-04
#========================================================#
#| [94m     Iteration 1: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -5.3e-04                                                   fdwrap: callM [0] =  5.3e-04                                                   fdwrap: callM [1] = -5.3e-04                                                   fdwrap: callM [1] =  5.3e-04                                                   fdwrap: callM [2] = -5.3e-04                                                   fdwrap: callM [2] =  5.3e-04                                                   fdwrap: callM [3] = -5.3e-04                                                   fdwrap: callM [3] =  5.3e-04                                                   fdwrap: callM [4] = -5.3e-04                                                   fdwrap: callM [4] =  5.3e-04                                                   fdwrap: callM [5] = -5.3e-04                                                   fdwrap: callM [5] =  5.3e-04                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 5.00092e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2771        2.0512     62.2619%     0.3877    1.000     0.3877 
    Gradient (kJ/mol/A)      49.2776      146.9576     33.5318%     0.1124    1.000     0.1124 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  79.9759 kJ/mol/A
fdwrap: callM [0] = -5.3e-04                                                   fdwrap: callM [0] =  5.3e-04                                                   fdwrap: callM [1] = -5.3e-04                                                   fdwrap: callM [1] =  5.3e-04                                                   fdwrap: callM [2] = -5.3e-04                                                   fdwrap: callM [2] =  5.3e-04                                                   fdwrap: callM [3] = -5.3e-04                                                   fdwrap: callM [3] =  5.3e-04                                                   fdwrap: callM [4] = -5.3e-04                                                   fdwrap: callM [4] =  5.3e-04                                                   fdwrap: callM [5] = -5.3e-04                                                   fdwrap: callM [5] =  5.3e-04                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00201e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1568.2684     1567.5058    100.0486%     1.0010    1.000     1.0010 
    Gradient (kJ/mol/A)   11085.3544    11079.6024    100.0519%     1.0010    1.000     1.0010 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.0694 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.50009      0.500 [92m     2.50046e-01[0m ( -1.129e-05 ) 
train_1                        2.00201      0.500 [92m     1.00101e+00[0m ( -1.190e-05 ) 
Regularization                 0.00000      1.000 [91m     2.82214e-07[0m ( +2.822e-07 ) 
Total                                             [92m     1.25105e+00[0m ( -2.291e-05 ) 
-------------------------------------------------------------------------------------
Creating the directory /home/curtie/7_FF_fitting/1_ForceBalance/2_playground/4_small_ref/4_ff-opt_test-full/1_opt/result/opt_1 to print the force field
#=====================================================================#
#|  The force field has been written to the result/opt_1 directory.  |#
#|    Input file with optimization parameters saved to opt_1.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     1   5.312e-03   5.312e-03   1.634e-02[92m   1.25105e+00[0m  -2.291e-05      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  7.53624041e-03 ] : COUL:SOL-2
   2 [  0.00000000e+00 ] : ANGLESK/HW-OW-HW
   3 [  0.00000000e+00 ] : ANGLESB/HW-OW-HW
   4 [ -7.01764409e-04 ] : VDWS/OW
   5 [ -1.44822135e-02 ] : VDWT/OW
----------------------------------------------------------
Convergence criterion reached for objective function (1.00e-03)
Calculating nonlinear optimization step
Finding trust radius: H+0.0000*I, length 3.4346e-02 (target 5.3124e-03)
Finding trust radius: H+9.0000*I, length 1.1373e-03 (target 5.3124e-03)
Finding trust radius: H+61.6869*I, length 2.3923e-04 (target 5.3124e-03)
Finding trust radius: H+9.0000*I, length 1.1373e-03 (target 5.3124e-03)
Finding trust radius: H+23.5623*I, length 5.4809e-04 (target 5.3124e-03)
Finding trust radius: H+3.4377*I, length 2.2721e-03 (target 5.3124e-03)
Finding trust radius: H+1.3131*I, length 4.7918e-03 (target 5.3124e-03)
Finding trust radius: H+0.5016*I, length 9.9256e-03 (target 5.3124e-03)
Finding trust radius: H+2.0062*I, length 3.4287e-03 (target 5.3124e-03)
Finding trust radius: H+0.9579*I, length 6.1402e-03 (target 5.3124e-03)
Finding trust radius: H+1.2088*I, length 5.1157e-03 (target 5.3124e-03)
Finding trust radius: H+1.1714*I, length 5.2444e-03 (target 5.3124e-03)
Finding trust radius: H+1.1449*I, length 5.3397e-03 (target 5.3124e-03)
Finding trust radius: H+1.1521*I, length 5.3134e-03 (target 5.3124e-03)
Finding trust radius: H+1.1526*I, length 5.3117e-03 (target 5.3124e-03)
Finding trust radius: H+1.1530*I, length 5.3101e-03 (target 5.3124e-03)
Starting Hessian diagonal search with step size 5.3117e-03
Hessian diagonal search: H+1.1526*I, length 5.3117e-03, result -4.9351e-05
Hessian diagonal search: H+53.2067*I, length 2.7331e-04, result -4.2403e-06
Hessian diagonal search: H+80.8518*I, length 1.8670e-04, result -2.9444e-06
Hessian diagonal search: H+1.1526*I, length 5.3117e-03, result -4.9351e-05
Hessian diagonal search: H+7.6787*I, length 1.2739e-03, result -1.6577e-05
Hessian diagonal search: H+11.9003*I, length 9.2846e-04, result -1.2786e-05
Hessian diagonal search: H+0.0676*I, length 2.5696e-02, result -1.7235e-04
Hessian diagonal search: H+0.5896*I, length 8.8499e-03, result -7.3796e-05
Hessian diagonal search: H+0.0107*I, length 3.2608e-02, result -2.0548e-04
Hessian diagonal search: H+0.0139*I, length 3.2117e-02, result -2.0326e-04
Hessian diagonal search: H+0.0004*I, length 3.4285e-02, result -2.1290e-04
Hessian diagonal search: H+0.0000*I, length 3.4346e-02, result -2.1316e-04
Hessian diagonal search: H+0.0000*I, length 3.4346e-02, result -2.1316e-04
Hessian diagonal search: H+0.0000*I, length 3.4346e-02, result -2.1316e-04
Hessian diagonal search: H+0.0000*I, length 3.4346e-02, result -2.1316e-04
Hessian diagonal search: H+0.0000*I, length 3.4346e-02, result -2.1316e-04
Optimization step found (length 3.4346e-02)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [ -4.7141e-03 - 3.4345e-02 = -3.9059e-02 ] : COUL:SOL-2
   2 [  0.0000e+00 - 1.0153e-20 = -1.0153e-20 ] : ANGLESK/HW-OW-HW
   3 [  0.0000e+00 - 7.9017e-21 = -7.9017e-21 ] : ANGLESB/HW-OW-HW
   4 [ -1.2429e-04 - 2.2425e-05 = -1.4671e-04 ] : VDWS/OW
   5 [ -2.4461e-03 + 2.1687e-04 = -2.2292e-03 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -6.4931e-01 + 1.3738e-02 = -6.3557e-01 ] : COUL:SOL-1
   1 [  3.2466e-01 - 6.8690e-03 =  3.1779e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 - 1.1867e-06 =  1.7564e+00 ] : VDWS/OW
   5 [  2.9170e-01 + 5.3762e-04 =  2.9224e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_1.sav
Setting finite difference step to 1.0000e-03
#========================================================#
#| [94m     Iteration 2: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 4.99648e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2734        2.0512     62.0803%     0.3854    1.000     0.3854 
    Gradient (kJ/mol/A)      49.6734      146.9576     33.8011%     0.1143    1.000     0.1143 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  80.1511 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00200e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1568.2570     1567.5058    100.0479%     1.0010    1.000     1.0010 
    Gradient (kJ/mol/A)   11085.3670    11079.6024    100.0520%     1.0010    1.000     1.0010 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.0972 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.49965      0.500 [92m     2.49824e-01[0m ( -2.221e-04 ) 
train_1                        2.00200      0.500 [92m     1.00100e+00[0m ( -6.137e-06 ) 
Regularization                 0.00002      1.000 [91m     1.53060e-05[0m ( +1.502e-05 ) 
Total                                             [92m     1.25084e+00[0m ( -2.132e-04 ) 
-------------------------------------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_1 directory.  |#
#|    Input file with optimization parameters saved to opt_1.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     2   3.912e-02   3.435e-02   1.023e-02[92m   1.25084e+00[0m  -2.132e-04      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  4.75001411e-03 ] : COUL:SOL-2
   2 [ -2.03061867e-22 ] : ANGLESK/HW-OW-HW
   3 [ -1.58034031e-22 ] : ANGLESB/HW-OW-HW
   4 [ -4.38228677e-04 ] : VDWS/OW
   5 [ -9.04515066e-03 ] : VDWT/OW
----------------------------------------------------------
Convergence criterion reached for objective function (1.00e-03)
Calculating nonlinear optimization step
Finding trust radius: H+0.0000*I, length 5.8593e-02 (target 3.4346e-02)
Finding trust radius: H+9.0000*I, length 7.4512e-04 (target 3.4346e-02)
Finding trust radius: H+23.5623*I, length 3.5073e-04 (target 3.4346e-02)
Finding trust radius: H+0.0000*I, length 5.8593e-02 (target 3.4346e-02)
Finding trust radius: H+3.4377*I, length 1.5459e-03 (target 3.4346e-02)
Finding trust radius: H+1.3131*I, length 3.4681e-03 (target 3.4346e-02)
Finding trust radius: H+0.0620*I, length 3.2823e-02 (target 3.4346e-02)
Finding trust radius: H+0.7432*I, length 5.7218e-03 (target 3.4346e-02)
Finding trust radius: H+0.1597*I, length 1.9399e-02 (target 3.4346e-02)
Finding trust radius: H+0.0613*I, length 3.2988e-02 (target 3.4346e-02)
Finding trust radius: H+0.0510*I, length 3.5601e-02 (target 3.4346e-02)
Finding trust radius: H+0.0195*I, length 4.6996e-02 (target 3.4346e-02)
Finding trust radius: H+0.0558*I, length 3.4328e-02 (target 3.4346e-02)
Finding trust radius: H+0.0558*I, length 3.4319e-02 (target 3.4346e-02)
Finding trust radius: H+0.0557*I, length 3.4345e-02 (target 3.4346e-02)
Finding trust radius: H+0.0539*I, length 3.4821e-02 (target 3.4346e-02)
Finding trust radius: H+0.0557*I, length 3.4354e-02 (target 3.4346e-02)
Starting Hessian diagonal search with step size 3.4345e-02
Hessian diagonal search: H+0.0557*I, length 3.4345e-02, result -1.1930e-04
Hessian diagonal search: H+4.2259*I, length 1.3157e-03, result -9.6112e-06
Hessian diagonal search: H+15.5571*I, length 4.9027e-04, result -4.3372e-06
Hessian diagonal search: H+0.0557*I, length 3.4345e-02, result -1.1930e-04
Hessian diagonal search: H+2.7307*I, length 1.8602e-03, result -1.2494e-05
Hessian diagonal search: H+0.4087*I, length 9.5412e-03, result -4.5697e-05
Hessian diagonal search: H+0.1620*I, length 1.9215e-02, result -7.9955e-05
Hessian diagonal search: H+0.0042*I, length 5.5618e-02, result -1.4616e-04
Hessian diagonal search: H+0.0031*I, length 5.6351e-02, result -1.4650e-04
Hessian diagonal search: H+0.0003*I, length 5.8390e-02, result -1.4725e-04
Hessian diagonal search: H+0.0002*I, length 5.8479e-02, result -1.4728e-04
Hessian diagonal search: H+0.0000*I, length 5.8583e-02, result -1.4731e-04
Hessian diagonal search: H+0.0077*I, length 5.3375e-02, result -1.4487e-04
Hessian diagonal search: H+0.0000*I, length 5.8593e-02, result -1.4731e-04
Hessian diagonal search: H+0.0000*I, length 5.8593e-02, result -1.4731e-04
Hessian diagonal search: H+0.0000*I, length 5.8593e-02, result -1.4731e-04
Hessian diagonal search: H+0.0000*I, length 5.8591e-02, result -1.4731e-04
Hessian diagonal search: H+0.0000*I, length 5.8593e-02, result -1.4731e-04
Hessian diagonal search: H+0.0000*I, length 5.8593e-02, result -1.4731e-04
Optimization step found (length 5.8593e-02)
#========================================================#
#| [95m  Mathematical Parameters (Current + Step = Next)   [0m |#
#========================================================#
   0 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-1
   1 [ -3.9059e-02 - 5.8592e-02 = -9.7651e-02 ] : COUL:SOL-2
   2 [ -1.0153e-20 + 4.1392e-20 =  3.1239e-20 ] : ANGLESK/HW-OW-HW
   3 [ -7.9017e-21 - 2.7251e-20 = -3.5152e-20 ] : ANGLESB/HW-OW-HW
   4 [ -1.4671e-04 - 3.9791e-05 = -1.8650e-04 ] : VDWS/OW
   5 [ -2.2292e-03 + 3.4029e-04 = -1.8889e-03 ] : VDWT/OW
----------------------------------------------------------
#========================================================#
#| [95m    Physical Parameters (Current + Step = Next)     [0m |#
#========================================================#
   0 [ -6.3557e-01 + 2.3437e-02 = -6.1214e-01 ] : COUL:SOL-1
   1 [  3.1779e-01 - 1.1718e-02 =  3.0607e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 + 0.0000e+00 =  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 + 0.0000e+00 =  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 - 2.1057e-06 =  1.7564e+00 ] : VDWS/OW
   5 [  2.9224e-01 + 8.4356e-04 =  2.9308e-01 ] : VDWT/OW
----------------------------------------------------------
Input file with saved parameters: opt_1.sav
#========================================================#
#| [94m     Iteration 3: Evaluating objective function     [0m |#
#| [94m        and derivatives through first order         [0m |#
#========================================================#
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|               Target: dynamics  Type: AbInitio_AMBER  Objective = 4.99214e-01                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)           1.2672        2.0512     61.7806%     0.3817    1.000     0.3817 
    Gradient (kJ/mol/A)      50.3808      146.9576     34.2825%     0.1175    1.000     0.1175 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 4 (H), frame 1,  80.4439 kJ/mol/A
fdwrap: callM [0] = -1.0e-03                                                   fdwrap: callM [0] =  1.0e-03                                                   fdwrap: callM [1] = -1.0e-03                                                   fdwrap: callM [1] =  1.0e-03                                                   fdwrap: callM [2] = -1.0e-03                                                   fdwrap: callM [2] =  1.0e-03                                                   fdwrap: callM [3] = -1.0e-03                                                   fdwrap: callM [3] =  1.0e-03                                                   fdwrap: callM [4] = -1.0e-03                                                   fdwrap: callM [4] =  1.0e-03                                                   fdwrap: callM [5] = -1.0e-03                                                   fdwrap: callM [5] =  1.0e-03                                                   
#================================================================================================#
#|                Target: train_1  Type: AbInitio_AMBER  Objective = 2.00198e+00                |#
#|                        Difference   Denominator     Percent                                  |#
#|  Observable            (Calc-Ref)     RMS (Ref)   Difference       Term   x Wt =   Contrib.  |#
#================================================================================================#
    Energy (kJ/mol)        1568.2381     1567.5058    100.0467%     1.0009    1.000     1.0009 
    Gradient (kJ/mol/A)   11085.3883    11079.6024    100.0522%     1.0010    1.000     1.0010 
--------------------------------------------------------------------------------------------------
Maximum force difference on atom 1 (H), frame 9, 55522.1432 kJ/mol/A
#===================================================================================#
#| [94m                         Objective Function Breakdown                          [0m |#
#| [94m  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) [0m |#
#===================================================================================#
dynamics                       0.49921      0.500 [92m     2.49607e-01[0m ( -2.173e-04 ) 
train_1                        2.00198      0.500 [92m     1.00099e+00[0m ( -1.015e-05 ) 
Regularization                 0.00010      1.000 [91m     9.53938e-05[0m ( +8.009e-05 ) 
Total                                             [92m     1.25069e+00[0m ( -1.473e-04 ) 
-------------------------------------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_1 directory.  |#
#|    Input file with optimization parameters saved to opt_1.sav.    |#
#=====================================================================#

  Step       |k|        |dk|       |grad|       -=X2=-     Delta(X2)    StepQual
     3   9.767e-02   5.859e-02   3.398e-04[92m   1.25069e+00[0m  -1.473e-04      1.000

#========================================================#
#| [94m                   Total Gradient                   [0m |#
#========================================================#
   0 [  0.00000000e+00 ] : COUL:SOL-1
   1 [  2.84156019e-04 ] : COUL:SOL-2
   2 [  6.24784071e-22 ] : ANGLESK/HW-OW-HW
   3 [ -7.03048242e-22 ] : ANGLESB/HW-OW-HW
   4 [ -6.80377279e-06 ] : VDWS/OW
   5 [ -1.86178432e-04 ] : VDWT/OW
----------------------------------------------------------
Convergence criterion reached for gradient norm (1.00e-03)
Convergence criterion reached for objective function (1.00e-03)
#========================================================#
#| [92m               [0m[1mOptimization Converged[0m               [0m |#
#| [92m           Final objective function value           [0m |#
#| [92m  Full:  1.250692e+00  Un-penalized:  1.250596e+00  [0m |#
#========================================================#
#========================================================#
#| [94m           Final optimization parameters:           [0m |#
#========================================================#
   0 [  0.0000e+00 ] : COUL:SOL-1
   1 [ -9.7651e-02 ] : COUL:SOL-2
   2 [  3.1239e-20 ] : ANGLESK/HW-OW-HW
   3 [ -3.5152e-20 ] : ANGLESB/HW-OW-HW
   4 [ -1.8650e-04 ] : VDWS/OW
   5 [ -1.8889e-03 ] : VDWT/OW
#========================================================#
#| [94m             Final physical parameters:             [0m |#
#========================================================#
   0 [ -6.1214e-01 ] : COUL:SOL-1
   1 [  3.0607e-01 ] : COUL:SOL-2
   2 [  1.0000e+02 ] : ANGLESK/HW-OW-HW
   3 [  1.0452e+02 ] : ANGLESB/HW-OW-HW
   4 [  1.7564e+00 ] : VDWS/OW
   5 [  2.9308e-01 ] : VDWT/OW
----------------------------------------------------------
#=====================================================================#
#|  The force field has been written to the result/opt_1 directory.  |#
#|    Input file with optimization parameters saved to opt_1.sav.    |#
#=====================================================================#
Wall time since calculation start: 8.6 seconds
#========================================================#
#| [1;44;93m               Calculation Finished.                [0m |#
#| [1;44;93m     ---==(  May the Force be with you!  )==---     [0m |#
#========================================================#
